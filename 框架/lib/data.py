# @author:九世
# @time:2019/5/11
# @file:data.py

import os
import re
import sys

sys.dont_write_bytecode=True

file=[]

def exec(text):
    zx=os.popen(text)
    print(zx.read())

def help():
    text='''
    help   查看帮助
    exec   执行系统命令
    use    选择指定的模块
    version 查看工具版本
    search 搜索模块
    exit   退出
    '''
    print(text)

def use(text):
    try:
        hostname=str(text).replace('/','.')
        path=__import__('plugin.{}'.format(hostname),fromlist=True)
        return path, hostname.replace('.', '/')
    except:
        print('[-] 没有这个模块')
        return 0

def version():
    versions='v 0.0.1'
    print('版本:{}'.format(versions))

def demo(text):
    hq=os.listdir(text)
    for k in hq:
        path=text+'/'+str(k)
        if os.path.isfile(path):
            file.append(path)

        if os.path.isdir(path):
            demo(path)

def search(text):
    paths=__file__
    paths='plugin'
    demo(paths)
    for v in file:
        zz=re.findall('plugin.*',str(v))
        for z in zz:
            files_paths=str(z).replace('plugin','').lstrip('/').replace('.py','')
            if text in files_paths:
                path=__import__('plugin.{}'.format(str(files_paths).lstrip('/').replace('/','.')),fromlist=True)
                value=getattr(path,'init')
                value=value()
                print('{}   author:{}   function:{}     time:{}'.format(files_paths,value['author'],value['fun'],value['time']))

    file.clear()



def exit():
    print('[*] 正在退出')